<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Contains models and tools to produce short-term forecasts for
    both case and sequence notifications assuming circulation of either
    one or two variants. Tools are also provided to allow the evaluation
    of the use of sequence data for short-term forecasts in both
    real-world settings and in user generated scenarios.">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/5/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Forecast Case and Sequence Notifications using Variant of Concern
    Strain Dynamics • forecast.vocs</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Forecast Case and Sequence Notifications using Variant of Concern
    Strain Dynamics">
<meta property="og:description" content="Contains models and tools to produce short-term forecasts for
    both case and sequence notifications assuming circulation of either
    one or two variants. Tools are also provided to allow the evaluation
    of the use of sequence data for short-term forecasts in both
    real-world settings and in user generated scenarios.">
<meta property="og:image" content="epiforecasts.io/forecast.vocs/reference/figures/README-unnamed-chunk-8-1.png">
<meta property="og:image:alt" content="An R package for forecasting case and sequence notifications using variant of concern strain dynamics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/5/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/5/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="preferably.css">
<link id="css-code-light" rel="stylesheet" href="code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
<script src="darkswitch.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">forecast.vocs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.9.1000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/model-definitions.html">Model definitions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiforecasts/forecast.vocs/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>

        
        <li>
          <a class="external-link nav-link" id="css-toggle-btn" aria-label="github">
            <span class="fas fa fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        
        
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="forecast-case-and-sequence-notifications-using-variant-of-concern-strain-dynamics">Forecast case and sequence notifications using variant of concern strain dynamics<a class="anchor" aria-label="anchor" href="#forecast-case-and-sequence-notifications-using-variant-of-concern-strain-dynamics"></a>
</h1></div>

<p><a href="https://epiforecasts.r-universe.dev/" class="external-link"><img src="https://epiforecasts.r-universe.dev/badges/forecast.vocs" alt="Universe"></a> <a href="https://github.com/epiforecasts/forecast.vocs/blob/master/LICENSE.md/" class="external-link"><img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="MIT license"></a> <a href="https://github.com/epiforecasts/forecast.vocs/graphs/contributors" class="external-link"><img src="https://img.shields.io/github/contributors/epiforecasts/forecast.vocs" alt="GitHub contributors"></a></p>
<p><a href="https://zenodo.org/badge/latestdoi/383161374" class="external-link"><img src="https://zenodo.org/badge/383161374.svg" alt="DOI"></a></p>
<p>Contains models and tools to produce short-term forecasts for both case and sequence notifications assuming circulation of either one or two variants. Tools are also provided to allow the evaluation of the use of sequence data for short-term forecasts in both real-world settings and in user generated scenarios.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="installing-the-package">Installing the package<a class="anchor" aria-label="anchor" href="#installing-the-package"></a>
</h3>
<p>Install the stable development version of the package with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"forecast.vocs"</span>, repos <span class="op">=</span> <span class="st">"https://epiforecasts.r-universe.dev"</span><span class="op">)</span></code></pre></div>
<p>Install the unstable development from GitHub using the following,</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"epiforecasts/forecast.vocs"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="installing-cmdstan">Installing CmdStan<a class="anchor" aria-label="anchor" href="#installing-cmdstan"></a>
</h3>
<p>If you don’t already have CmdStan installed then, in addition to installing <code>forecast.vocs</code>, it is also necessary to install CmdStan using CmdStanR’s <code>install_cmdstan()</code> function to enable model fitting in <code>forecast.vocs</code>. A suitable C++ toolchain is also required. Instructions are provided in the <a href="https://mc-stan.org/cmdstanr/articles/cmdstanr.html" class="external-link"><em>Getting started with CmdStanR</em></a> vignette. See the <a href="https://mc-stan.org/cmdstanr/" class="external-link">CmdStanR documentation</a> for further details and support.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/install_cmdstan.html" class="external-link">install_cmdstan</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>This quick start uses data from Germany that includes COVID-19 notifications and sequences with sequences either being positive or negative for the Delta variant. It shows how to produce forecasts for both a one and two strain model for the 19th of June 2021 when the latest available data estimated that approximately 7% of COVID-19 were positive for the Delta variant. Note that estimated growth rates and reproduction numbers shown here have been rescaled using an assumed generation time of 5.5 days and a weakly informative prior centred around Delta being 50% more transmissible than non-Delta cases has been used.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://epiforecasts.io/forecast.vocs/">forecast.vocs</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>

<span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filter_by_availability.html">filter_by_availability</a></span><span class="op">(</span>
  <span class="va">germany_covid19_delta_obs</span>,
  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-06-19"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">obs</span>
<span class="co">#&gt;           date location_name location  cases cases_available seq_total seq_voc</span>
<span class="co">#&gt;  1: 2021-03-20       Germany       DE  87328      2021-03-20        NA      NA</span>
<span class="co">#&gt;  2: 2021-03-27       Germany       DE 109442      2021-03-27        NA      NA</span>
<span class="co">#&gt;  3: 2021-04-03       Germany       DE 117965      2021-04-03        NA      NA</span>
<span class="co">#&gt;  4: 2021-04-10       Germany       DE 107223      2021-04-10        NA      NA</span>
<span class="co">#&gt;  5: 2021-04-17       Germany       DE 142664      2021-04-17      4072       6</span>
<span class="co">#&gt;  6: 2021-04-24       Germany       DE 145568      2021-04-24      4500      32</span>
<span class="co">#&gt;  7: 2021-05-01       Germany       DE 131887      2021-05-01      3607      55</span>
<span class="co">#&gt;  8: 2021-05-08       Germany       DE 107141      2021-05-08      4491      86</span>
<span class="co">#&gt;  9: 2021-05-15       Germany       DE  77261      2021-05-15      3443      92</span>
<span class="co">#&gt; 10: 2021-05-22       Germany       DE  57310      2021-05-22      3392     114</span>
<span class="co">#&gt; 11: 2021-05-29       Germany       DE  33052      2021-05-29      2258      89</span>
<span class="co">#&gt; 12: 2021-06-05       Germany       DE  22631      2021-06-05      1136      75</span>
<span class="co">#&gt; 13: 2021-06-12       Germany       DE  15553      2021-06-12        NA      NA</span>
<span class="co">#&gt; 14: 2021-06-19       Germany       DE   7659      2021-06-19        NA      NA</span>
<span class="co">#&gt;       share_voc seq_available</span>
<span class="co">#&gt;  1:          NA          &lt;NA&gt;</span>
<span class="co">#&gt;  2:          NA          &lt;NA&gt;</span>
<span class="co">#&gt;  3:          NA          &lt;NA&gt;</span>
<span class="co">#&gt;  4:          NA          &lt;NA&gt;</span>
<span class="co">#&gt;  5: 0.001473477    2021-06-16</span>
<span class="co">#&gt;  6: 0.007111111    2021-06-16</span>
<span class="co">#&gt;  7: 0.015248129    2021-06-16</span>
<span class="co">#&gt;  8: 0.019149410    2021-06-16</span>
<span class="co">#&gt;  9: 0.026720883    2021-06-16</span>
<span class="co">#&gt; 10: 0.033608491    2021-06-16</span>
<span class="co">#&gt; 11: 0.039415412    2021-06-16</span>
<span class="co">#&gt; 12: 0.066021127    2021-06-16</span>
<span class="co">#&gt; 13:          NA    2021-07-29</span>
<span class="co">#&gt; 14:          NA    2021-07-29</span>

<span class="va">current_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/latest_obs.html">latest_obs</a></span><span class="op">(</span><span class="va">germany_covid19_delta_obs</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="forecast-all-in-one">Forecast all-in-one<a class="anchor" aria-label="anchor" href="#forecast-all-in-one"></a>
</h3>
<p>Run a forecast for both one and two strain models (or optionally just one of these) using the <code><a href="reference/forecast.html">forecast()</a></code> function. This provides a wrapper around other package tooling to initialise, fit, and summarise forecasts. Multiple forecasts can be performed efficiently across dates and scenarios using <code><a href="reference/forecast_across_dates.html">forecast_across_dates()</a></code> and <code><a href="reference/forecast_across_scenarios.html">forecast_across_scenarios()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">forecasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/forecast.html">forecast</a></span><span class="op">(</span><span class="va">obs</span>,
  strains <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, voc_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span>,
  voc_label <span class="op">=</span> <span class="st">"Delta"</span>, scale_r <span class="op">=</span> <span class="fl">5.5</span> <span class="op">/</span> <span class="fl">7</span>,
  adapt_delta <span class="op">=</span> <span class="fl">0.99</span>, max_treedepth <span class="op">=</span> <span class="fl">15</span>,
  refresh <span class="op">=</span> <span class="fl">0</span>, show_messages <span class="op">=</span> <span class="cn">FALSE</span>,
<span class="op">)</span>
<span class="co">#&gt; Running MCMC with 4 parallel chains...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Chain 4 finished in 20.3 seconds.</span>
<span class="co">#&gt; Chain 2 finished in 20.6 seconds.</span>
<span class="co">#&gt; Chain 3 finished in 21.0 seconds.</span>
<span class="co">#&gt; Chain 1 finished in 31.7 seconds.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; All 4 chains finished successfully.</span>
<span class="co">#&gt; Mean chain execution time: 23.4 seconds.</span>
<span class="co">#&gt; Total execution time: 31.9 seconds.</span>
<span class="co">#&gt; Running MCMC with 4 parallel chains...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Chain 4 finished in 62.6 seconds.</span>
<span class="co">#&gt; Chain 2 finished in 62.7 seconds.</span>
<span class="co">#&gt; Chain 1 finished in 67.6 seconds.</span>
<span class="co">#&gt; Chain 3 finished in 82.8 seconds.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; All 4 chains finished successfully.</span>
<span class="co">#&gt; Mean chain execution time: 68.9 seconds.</span>
<span class="co">#&gt; Total execution time: 82.9 seconds.</span>
<span class="va">forecasts</span>
<span class="co">#&gt;    id forecast_date strains overdispersion variant_relationship  r_init</span>
<span class="co">#&gt; 1:  0    2021-06-19       1           TRUE               pooled 0, 0.25</span>
<span class="co">#&gt; 2:  0    2021-06-19       2           TRUE               pooled 0, 0.25</span>
<span class="co">#&gt;    voc_scale error               fit       data  fit_args samples max_rhat</span>
<span class="co">#&gt; 1:  0.4, 0.2       &lt;CmdStanMCMC[31]&gt; &lt;list[20]&gt; &lt;list[5]&gt;    4000     1.01</span>
<span class="co">#&gt; 2:  0.4, 0.2       &lt;CmdStanMCMC[31]&gt; &lt;list[20]&gt; &lt;list[5]&gt;    4000     1.01</span>
<span class="co">#&gt;    divergent_transitions per_divergent_transitions max_treedepth</span>
<span class="co">#&gt; 1:                     2                     5e-04            11</span>
<span class="co">#&gt; 2:                    28                     7e-03            10</span>
<span class="co">#&gt;    no_at_max_treedepth per_at_max_treedepth time              posterior</span>
<span class="co">#&gt; 1:                 841              0.21025 31.9 &lt;fv_posterior[148x20]&gt;</span>
<span class="co">#&gt; 2:                2139              0.53475 82.9 &lt;fv_posterior[426x20]&gt;</span>
<span class="co">#&gt;                 forecast</span>
<span class="co">#&gt; 1: &lt;fv_posterior[12x13]&gt;</span>
<span class="co">#&gt; 2: &lt;fv_posterior[60x13]&gt;</span></code></pre></div>
<p>Summarised posterior and forecast estimates can be directly extracted from the output using the included <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method. Alternatively, the complete summarised posterior can be extracted using the following (which also has its own <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> and <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> options to make exploring the results easier). See the documentation for further details.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">forecasts</span>, target <span class="op">=</span> <span class="st">"posterior"</span>, type <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></code></pre></div>
<p>Plot the posterior prediction for cases from the single strain model (“Overall”), from the two strain model (“Combined”), and the unobserved estimates for each strain.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">forecasts</span>, <span class="va">current_obs</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<p>Plot the posterior prediction for the fraction of cases that have the Delta variant from the two strain model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">forecasts</span>, <span class="va">current_obs</span>, type <span class="op">=</span> <span class="st">"voc_frac"</span>, voc_label <span class="op">=</span> <span class="st">"Delta variant"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
<p>Plot the posterior estimate for the growth rate over the mean of the generation time for COVID-19 cases (here assumed to be 5.5 days).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">forecasts</span>, type <span class="op">=</span> <span class="st">"growth"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
<p>Plot the posterior estimate for the effective reproduction number of Delta and non-Delta cases.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">forecasts</span>, type <span class="op">=</span> <span class="st">"rt"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%"></p>
<p>Plot the estimated transmission advantage for Delta vs non-Delta over time. Note that as here a model with a pooled variant scaling has been used this varies over time (potentially suitable where imports or present or a variant has greater immune escape than the baseline). If it is likely that the growth advantage is constant over time consider the fixed scaling model. If the variants are likely to be circulating in independent populations consider the independent variant model. See the documentation and model definition vignette for details.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">forecasts</span>, type <span class="op">=</span> <span class="st">"voc_advantage"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
<p>Alternatively a list of all plots with sensible defaults can be produced using the following.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">forecasts</span>, <span class="va">current_obs</span>, type <span class="op">=</span> <span class="st">"all"</span>, voc_label <span class="op">=</span> <span class="st">"Delta variant"</span><span class="op">)</span></code></pre></div>
<p>A potentially useful optional integration with <a href="https://epiforecasts.io/scoringutils/" class="external-link"><code>scoringutils</code></a> package is also provided to streamline scoring forecasts using proper scoring rules. See the documentation of the <code>scoringutils</code> package for more on this but as a simple example below we calculate average scores both the single and two strain models for this single Forecast</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiforecasts/scoringutils" class="external-link">scoringutils</a></span><span class="op">)</span>
<span class="co">#&gt; Note: The definition of the weighted interval score has slightly changed in version 0.1.5. If you want to use the old definition, use the argument `count_median_twice = TRUE` in the function `eval_forecasts()`</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>

<span class="va">pp_forecasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">forecasts</span>, target <span class="op">=</span> <span class="st">"forecast"</span>, type <span class="op">=</span> <span class="st">"cases"</span><span class="op">)</span>
<span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fv_score_forecast.html">fv_score_forecast</a></span><span class="op">(</span><span class="va">pp_forecasts</span>, <span class="va">current_obs</span>, summarise_by <span class="op">=</span> <span class="st">"strains"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="7%">
<col width="16%">
<col width="10%">
<col width="16%">
<col width="15%">
<col width="21%">
<col width="7%">
<col width="3%">
</colgroup>
<thead><tr class="header">
<th align="right">strains</th>
<th align="right">interval_score</th>
<th align="right">sharpness</th>
<th align="right">underprediction</th>
<th align="right">overprediction</th>
<th align="right">coverage_deviation</th>
<th align="right">bias</th>
<th align="right">aem</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2040</td>
<td align="right">272</td>
<td align="right">1760</td>
<td align="right">0</td>
<td align="right">-0.375</td>
<td align="right">-0.967</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1110</td>
<td align="right">499</td>
<td align="right">616</td>
<td align="right">0</td>
<td align="right">0.000</td>
<td align="right">-0.900</td>
<td align="right">NaN</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="step-by-step-forecast">Step by step forecast<a class="anchor" aria-label="anchor" href="#step-by-step-forecast"></a>
</h3>
<p>Rather than using the all-in-one <code><a href="reference/forecast.html">forecast()</a></code> function individual package functions can be used to produce a forecast as follows.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fv_as_data_list.html">fv_as_data_list</a></span><span class="op">(</span><span class="va">obs</span>, horizon <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>

<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fv_model.html">fv_model</a></span><span class="op">(</span>strains <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fv_inits.html">fv_inits</a></span><span class="op">(</span><span class="va">dt</span>, strains <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fv_sample.html">fv_sample</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">dt</span>, model <span class="op">=</span> <span class="va">model</span>, init <span class="op">=</span> <span class="va">inits</span>,
  voc_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span>,
  adapt_delta <span class="op">=</span> <span class="fl">0.99</span>, max_treedepth <span class="op">=</span> <span class="fl">15</span>,
  refresh <span class="op">=</span> <span class="fl">0</span>, show_messages <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fv_tidy_posterior.html">fv_tidy_posterior</a></span><span class="op">(</span><span class="va">fit</span>, voc_label <span class="op">=</span> <span class="st">"Delta"</span>, scale_r <span class="op">=</span> <span class="fl">5.5</span> <span class="op">/</span> <span class="fl">7</span><span class="op">)</span></code></pre></div>
<p>As for forecasts produced with the <code><a href="reference/forecast.html">forecast()</a></code> function summary plots and estimates can then be produced using <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, and <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> methods. For example case forecasts can be returned using the following,</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">posterior</span>, type <span class="op">=</span> <span class="st">"cases"</span>, forecast <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If using <code>forecast.vocs</code> in your work please consider citing it using the following,</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">#&gt; To cite forecast.vocs in publications use:</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt; </span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt;   Sam Abbott (2021). forecast.vocs: Forecast case and sequence</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt;   notifications using variant of concern strain dynamics, DOI:</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt;   10.5281/zenodo.5559016</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt; </span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#&gt; </span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#&gt;   @Article{,</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">#&gt;     title = {forecast.vocs: Forecast case and sequence notifications using variant of concern strain dynamics},</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">#&gt;     author = {Sam Abbott},</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">#&gt;     journal = {Zenodo},</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co">#&gt;     year = {2021},</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">#&gt;     doi = {10.5281/zenodo.5559016},</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">#&gt;   }</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-to-make-a-bug-report-or-feature-request">How to make a bug report or feature request<a class="anchor" aria-label="anchor" href="#how-to-make-a-bug-report-or-feature-request"></a>
</h2>
<p>Please briefly describe your problem and what output you expect in an <a href="https://github.com/epiforecasts/forecast.vocs/issues" class="external-link">issue</a>. If you have a question, please don’t open an issue. Instead, ask on our <a href="https://github.com/epiforecasts/forecast.vocs/discussions/categories/q-a" class="external-link">Q and A page</a>.</p>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>We welcome contributions and new contributors! We particularly appreciate help on priority problems in the <a href="https://github.com/epiforecasts/forecast.vocs/issues" class="external-link">issues</a>. Please check and add to the issues, and/or add a <a href="https://github.com/epiforecasts/forecast.vocs/pulls" class="external-link">pull request</a>.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the <code>forecast.vocs</code> project is released with a <a href="epiforecasts.io/forecast.vocs/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/forecast.vocs/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/epiforecasts/forecast.vocs/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing forecast.vocs</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/forecast.vocs/actions/workflows/R-CMD-as-cran-check.yaml" class="external-link"><img src="https://github.com/epiforecasts/forecast.vocs/actions/workflows/R-CMD-as-cran-check.yaml/badge.svg" alt="R-CMD-as-cran-check"></a></li>
<li><a href="https://app.codecov.io/gh/epiforecasts/forecast.vocs" class="external-link"><img src="https://codecov.io/gh/epiforecasts/forecast.vocs/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.9000.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
